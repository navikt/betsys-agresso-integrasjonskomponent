image: "docker.adeo.no:5000/okonomi/betsys-agresso-integrasjonskomponent"
team: okonomi
replicas:
  min: 1
  max: 1
port: 8080
alerts:
- alert: errorDetected
  expr: increase(logd_messages_total{app="nais-logd",log_app="betsys-agresso-integrasjonskomponent",log_level="Error"}[5m]) > 0
  for: 2m
  annotations:
    action: Read app logs(application:betsys-agresso-integrasjonskomponent).
    severity: Error
- alert: errorDetected
  expr: time() - agresso_to_betsys_sftp_health_check > 180
  annotations:
    action: Sftp health check failed
    severity: Error
healthcheck:
  liveness:
    path: /actuator/info
    # wait 30 seconds before trying to check status,
    # and then try 30 times with 5 second intervals before
    # killing the pod: 30 + 5*30 = 180 seconds before pod is killed
    initialDelay: 30
    periodSeconds: 5
    failureThreshold: 30
  readiness:
    path: /actuator/health
    initialDelay: 30
    periodSeconds: 5
    failureThreshold: 30
prometheus:
  enabled: true
  path: /actuator/prometheus
ingress:
  enabled: true
resources:
  limits:
    cpu: 4000m
    memory: 4Gi
  requests:
    cpu: 1000m
    memory: 1Gi
secrets: true
fasitResources:
  used:
  - alias: mqGateway01
    resourceType: queueManager
  - alias: betsys_channel
    propertyMap:
      name: CHANNELNAME
    resourceType: channel
  - alias: betsys_SENDING_TIL_AGRESSO
    resourceType: queue
    propertyMap:
      queueName: SENDING_TIL_AGRESSO_QUEUE
  - alias: betsys_SENDING_TIL_BANK
    resourceType: queue
    propertyMap:
      queueName: SENDING_TIL_BANK_QUEUE
